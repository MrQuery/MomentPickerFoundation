!function(t){var n="MomentPicker",a=moment().startOf("day"),e={date:a,level:0,style:{selected:"selected",current:"current"}};t.fn[n]=function(r){var o=t(this).data(n);return o?o:this.each(function(){var o,c=t.extend(!0,{},e,r),s=c.date,i=s.clone(),u=t(this),d=c.level;u.html(['<div class="header">','<a class="prev"></a>','<a class="current"></a>','<a class="next"></a>',"</div>",'<div class="body"></div>'].join(""));var f=u.children("div.header"),l=u.children("div.body"),m=f.children("a.next"),Y=f.children("a.prev"),h=f.children("a.current"),v=function(){return!1},y=v,M=v,p=v,g=v,x=v,O=v,k=v,w=v,D=function(t){t instanceof Function?k=t:!function(){var n=moment(t);moment.isMoment(n)&&(n.startOf("day"),k=function(){return n.clone()})}(),x=function(t){return t<k().year()},p=function(t){return t.clone().startOf("month")<k().startOf("month")},y=function(t){return t<k()};var n=k();n>i?E(n):A()},j=function(t){t instanceof Function?w=t:!function(){var n=moment(t);moment.isMoment(n)&&(n.startOf("day"),w=function(){return n.clone()})}(),O=function(t){return t>w().year()},g=function(t){return t.clone().startOf("month")>w().startOf("month")},M=function(t){return t>w()};var n=w();i>n?E(n):A()},P=function(n){var a=t.Event(n);a.api=o,u.trigger(a)},b=function(t){return!x(t)&&!O(t)},C=function(t){return!y(t)&&!M(t)},F=function(t){return!p(t)&&!g(t)},E=function(){if(arguments.length>0){var t=moment(arguments[0]);return t.isValid()&&(t.startOf("day"),C(t)&&(i=t,P("pick"),s=i.clone(),A())),o}return i.clone()},N=function(){var t=s.year(),n=t+12,e="";for(h.text(t+" - "+(n-1));n>t;){var r=[];t===a.year()&&r.push(c.style.current),t===i.year()&&r.push(c.style.selected);var o=b(t)?"a":"span";e+="<"+o+' data-year="'+t+'" class="'+r.join(" ")+'">'+t+"</"+o+">",t++}l.html(e),P("renderYears")},Q=function(){var t=s.clone().startOf("y"),n=t.clone().add("M",12),e="";for(h.text(t.year());n>t;){var r=[];t.format("M-YYYY")===a.format("M-YYYY")&&r.push(c.style.current),t.format("M-YYYY")===i.format("M-YYYY")&&r.push(c.style.selected);var o=F(t)?"a":"span";e+="<"+o+' data-month="'+t.format("M-YYYY")+'" class="'+r.join(" ")+'">'+t.format("MMM")+"</"+o+">",t.add("M",1)}l.html(e),P("renderMonths")},V=function(){var t=s.clone().startOf("w"),n=t.clone().add("w",1),e='<div class="week">';for(h.text(s.format("MMMM YYYY"));n>t;)e+="<span>"+t.format("ddd")+"</span>",t.add("d",1);e+="</div>",t=s.clone().startOf("M").startOf("w"),n=t.clone().add("d",42),e+='<div class="month">';for(var r=!1;n>t;){var o=[];t.format("D-M-YYYY")===a.format("D-M-YYYY")&&o.push(c.style.current),t.format("D-M-YYYY")===i.format("D-M-YYYY")&&o.push(c.style.selected);var u=C(t)?"a":"span";t.month()!==s.month()?o.push(r?"next":"prev"):r=!0,e+="<"+u+' data-day="'+t.format("D-M-YYYY")+'" class="'+o.join(" ")+'">'+t.date()+"</"+u+">",t.add("d",1)}e+="</div>",l.html(e),P("renderDays")},q=[{years:12},{years:1},{months:1}],z=[N,Q,V],A=function(){arguments.length>0&&(d=Math.max(arguments[0],c.level)),u.removeClass("top"),d===c.level&&u.addClass("top"),z[d](),P("render")},B=function(){s.add(q[d]),A(),P("showNext")},G=function(){s.subtract(q[d]),A(),P("showPrev")};m.click(B),Y.click(G),h.click(function(){A(Math.max(0,--d))}),l.on("click","a[data-year]",function(){s.year(t(this).data("year")),A(1)}),l.on("click","a[data-month]",function(){var n=moment(t(this).data("month"),"M-YYYY");s.month(n.month()).year(n.year()),A(2)}),l.on("click","a[data-day]",function(){E(moment(t(this).data("day"),"D-M-YYYY"))});var H=function(){return arguments.length>0?(D(arguments[0]),o):k()},I=function(){return arguments.length>0?(j(arguments[0]),o):w()};o={val:E,next:B,prev:G,min:H,max:I,renderYears:function(){A(0)},renderMonths:function(){A(1)},renderDays:function(){A(2)}},c.hasOwnProperty("min")&&D(c.min),c.hasOwnProperty("max")&&j(c.max),u.data(n,o),P("ready"),A()})}}(jQuery);